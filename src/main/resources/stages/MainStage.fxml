<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane fx:id="mainPane" xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="application.mainapplication.ExamsManagerController">

    <!-- ========================= LEFT SIDE ========================= -->
    <left>
        <VBox fx:id="leftBox" spacing="10">
            <children>
                <TableView fx:id="examTable">
                    <VBox.margin>
                        <Insets top="20" right="20" bottom="10" left="20"/>
                    </VBox.margin>
                    <columns>
                        <TableColumn fx:id="colName" text="Nome"/>
                        <TableColumn fx:id="colWeight" text="P"/>
                        <TableColumn fx:id="colGrade" text="V"/>
                        <TableColumn fx:id="colDate" text="Data"/>
                    </columns>
                </TableView>

                <GridPane fx:id="buttonsGrid" hgap="10" vgap="10" maxWidth="Infinity">
                    <VBox.margin>
                        <Insets top="10" right="20" bottom="20" left="20"/>
                    </VBox.margin>

                    <columnConstraints>
                        <ColumnConstraints percentWidth="50" hgrow="ALWAYS"/>
                        <ColumnConstraints percentWidth="50" hgrow="ALWAYS"/>
                    </columnConstraints>

                    <rowConstraints>
                        <RowConstraints vgrow="NEVER"/>
                        <RowConstraints vgrow="NEVER"/>
                    </rowConstraints>

                    <children>
                        <!-- Riga 0 -->
                        <Button fx:id="addButton" text="Aggiungi" focusTraversable="false"
                                maxWidth="Infinity" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                onAction="#addExamButtonOnAction"/>

                        <Button fx:id="removeButton" text="Rimuovi" focusTraversable="false"
                                maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                onAction="#removeButtonOnAction"/>

                        <!-- Riga 1 -->
                        <Button fx:id="settingsButton" text="Impostazioni" focusTraversable="false"
                                maxWidth="Infinity" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                onAction="#settingButtonOnAction"/>

                        <Button fx:id="modifyButton" text="Modifica" focusTraversable="false"
                                maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                onAction="#modifyButtonOnAction"/>
                    </children>
                </GridPane>

            </children>
        </VBox>
    </left>


    <!-- ========================= RIGHT SIDE ========================= -->
    <right>
        <VBox fx:id="rightBox" spacing="20">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <children>

                <!-- ===== FASCIA 1: GRAFICI ===== -->
                <HBox fx:id="chartsRow1" spacing="20" VBox.vgrow="ALWAYS">

                    <!-- PIE CHART BOX (30%) -->
                    <VBox fx:id="pieChartBox"
                          styleClass="chart-container"
                          HBox.hgrow="ALWAYS"
                          alignment="CENTER">
                        <padding>
                            <Insets top="10" right="10" bottom="10" left="10"/>
                        </padding>

                        <children>

                            <PieChart fx:id="pieChartTotalExam"
                                      legendVisible="false">
                                <VBox.vgrow>ALWAYS</VBox.vgrow>
                            </PieChart>

                            <Label fx:id="pieChartLabel"
                                   text="Progress"
                                   styleClass="piechart-title">
                                <VBox.margin>
                                    <Insets top="12"/>
                                </VBox.margin>
                            </Label>

                        </children>
                    </VBox>



                    <!-- LINE CHART BOX (70%) -->
                    <VBox fx:id="lineChartBox" styleClass="chart-container"
                          HBox.hgrow="ALWAYS">
                        <padding>
                            <Insets top="10" right="10" bottom="10" left="10"/>
                        </padding>
                        <children>
                            <LineChart fx:id="lineChart"
                                       animated="false"
                                       createSymbols="true">
                                <VBox.vgrow>ALWAYS</VBox.vgrow>

                                <xAxis>
                                    <CategoryAxis fx:id="timeAxisInLineChart"/>
                                </xAxis>

                                <yAxis>
                                    <NumberAxis fx:id="gradeAxisInLineChart"
                                                lowerBound="17"
                                                upperBound="31"
                                                tickUnit="1"
                                                autoRanging="false"/>
                                </yAxis>
                            </LineChart>
                        </children>
                    </VBox>

                </HBox>

                <!-- ===== FASCIA 2: MEDIA / MEDIA PONDERATA / MEDIANA ===== -->
                <HBox spacing="20">
                    <VBox fx:id="meanBox" HBox.hgrow="ALWAYS" styleClass="stat-box">
                        <children>
                            <Label fx:id="aritmethicMeanLabel" styleClass="stat-value"/>
                            <Label text="Media" styleClass="stat-title"/>
                        </children>
                    </VBox>

                    <VBox fx:id="weightedMeanBox" HBox.hgrow="ALWAYS" styleClass="stat-box">
                        <children>
                            <Label fx:id="weightedMeanLabel" styleClass="stat-value"/>
                            <Label text="Media ponderata" styleClass="stat-title"/>
                        </children>
                    </VBox>

                    <VBox fx:id="medianBox" HBox.hgrow="ALWAYS" styleClass="stat-box">
                        <children>
                            <Label fx:id="medianLabel" styleClass="stat-value"/>
                            <Label text="Mediana" styleClass="stat-title"/>
                        </children>
                    </VBox>
                </HBox>

                <!-- ===== FASCIA 3: MODA / DEV.STD / VAR / MEDIA 5 ESAMI ===== -->
                <HBox spacing="20">
                    <VBox fx:id="modeBox" HBox.hgrow="ALWAYS" styleClass="stat-box">
                        <children>
                            <Label fx:id="modeLabel" styleClass="stat-value"/>
                            <Label text="Moda" styleClass="stat-title"/>
                        </children>
                    </VBox>

                    <VBox fx:id="stdDevBox" HBox.hgrow="ALWAYS" styleClass="stat-box">
                        <children>
                            <Label fx:id="standardDeviationLabel" styleClass="stat-value"/>
                            <Label text="Deviazione standard" styleClass="stat-title"/>
                        </children>
                    </VBox>

                    <VBox fx:id="interQuartileBox" HBox.hgrow="ALWAYS" styleClass="stat-box">
                        <children>
                            <Label fx:id="interQuartileLabel" styleClass="stat-value"/>
                            <Label text="Variazione quartili interni" styleClass="stat-title"/>
                        </children>
                    </VBox>

                    <VBox fx:id="weightedLastFiveBox" HBox.hgrow="ALWAYS" styleClass="stat-box">
                        <children>
                            <Label fx:id="weightedMeanLastFiveExamsLabel" styleClass="stat-value"/>
                            <Label text="Media ponderata (ultimi 5)" styleClass="stat-title"/>
                        </children>
                    </VBox>
                </HBox>

            </children>
        </VBox>
    </right>

</BorderPane>
